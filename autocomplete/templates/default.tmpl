{{define "lvt:autocomplete:default:v1"}}
{{if .IsStyled}}
{{/* Tailwind CSS styled version */}}
<div class="relative" data-autocomplete="{{.ID}}">
  <div class="relative">
    <input
      type="text"
      class="w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 {{if .Loading}}pr-10{{end}}"
      placeholder="{{.Placeholder}}"
      value="{{.Query}}"
      lvt-input="query_{{.ID}}"
      lvt-focus="focus_{{.ID}}"
      lvt-keydown="keydown_{{.ID}}"
      autocomplete="off"
      aria-autocomplete="list"
      aria-haspopup="listbox"
      aria-expanded="{{.Open}}"
      {{if .Open}}aria-controls="suggestions_{{.ID}}"{{end}}
    />
    {{if .Loading}}
    <div class="absolute inset-y-0 right-0 flex items-center pr-3">
      <svg class="w-5 h-5 text-gray-400 animate-spin" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
      </svg>
    </div>
    {{else if .HasSelection}}
    <button
      type="button"
      class="absolute inset-y-0 right-0 flex items-center pr-3"
      lvt-click="clear_{{.ID}}"
      aria-label="Clear selection"
    >
      <svg class="w-5 h-5 text-gray-400 hover:text-gray-600" viewBox="0 0 20 20" fill="currentColor">
        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" />
      </svg>
    </button>
    {{end}}
  </div>

  {{if .Open}}
  <ul
    id="suggestions_{{.ID}}"
    class="absolute z-10 w-full mt-1 bg-white border border-gray-200 rounded-md shadow-lg max-h-60 overflow-auto"
    role="listbox"
    lvt-click-away="blur_{{.ID}}"
  >
    {{range $index, $suggestion := .FilteredSuggestions}}
    <li
      class="px-4 py-2 cursor-pointer
        {{if $suggestion.Disabled}}text-gray-400 cursor-not-allowed{{else if $.IsHighlighted $index}}bg-blue-600 text-white{{else}}text-gray-900 hover:bg-gray-100{{end}}"
      role="option"
      {{if not $suggestion.Disabled}}
      lvt-click="select_{{$.ID}}"
      lvt-data-index="{{$index}}"
      {{end}}
      aria-selected="{{$.IsHighlighted $index}}"
      {{if $suggestion.Disabled}}aria-disabled="true"{{end}}
    >
      <div class="flex items-center">
        {{if $suggestion.Icon}}
        <span class="mr-2">{{$suggestion.Icon}}</span>
        {{end}}
        <div>
          <div class="font-medium">{{$suggestion.Label}}</div>
          {{if $suggestion.Description}}
          <div class="text-sm {{if $.IsHighlighted $index}}text-blue-200{{else}}text-gray-500{{end}}">{{$suggestion.Description}}</div>
          {{end}}
        </div>
      </div>
    </li>
    {{else}}
    <li class="px-4 py-2 text-gray-500 text-center">No suggestions found</li>
    {{end}}
  </ul>
  {{end}}
</div>
{{else}}
{{/* Unstyled semantic HTML version */}}
<div data-autocomplete="{{.ID}}">
  <input
    type="text"
    placeholder="{{.Placeholder}}"
    value="{{.Query}}"
    lvt-input="query_{{.ID}}"
    lvt-focus="focus_{{.ID}}"
    lvt-keydown="keydown_{{.ID}}"
    autocomplete="off"
    aria-autocomplete="list"
    aria-haspopup="listbox"
    aria-expanded="{{.Open}}"
  />
  {{if .HasSelection}}
  <button type="button" lvt-click="clear_{{.ID}}">Clear</button>
  {{end}}

  {{if .Open}}
  <ul role="listbox" lvt-click-away="blur_{{.ID}}">
    {{range $index, $suggestion := .FilteredSuggestions}}
    <li
      role="option"
      {{if not $suggestion.Disabled}}
      lvt-click="select_{{$.ID}}"
      lvt-data-index="{{$index}}"
      {{end}}
      aria-selected="{{$.IsHighlighted $index}}"
    >
      {{$suggestion.Label}}
      {{if $suggestion.Description}}<small>{{$suggestion.Description}}</small>{{end}}
    </li>
    {{else}}
    <li>No suggestions found</li>
    {{end}}
  </ul>
  {{end}}
</div>
{{end}}
{{end}}
